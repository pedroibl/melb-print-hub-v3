import{r,j as e}from"./app-BE0YVVjn.js";const T=({siteKey:a,onVerify:t})=>{const n=r.useRef(null),[d,h]=r.useState(!1),[o,u]=r.useState(null),[l,c]=r.useState(null),f=r.useRef(!0),s=r.useCallback(()=>{if(o!==null&&window.grecaptcha&&window.grecaptcha.reset)try{window.grecaptcha.reset(o)}catch(i){console.log("Error resetting reCAPTCHA:",i)}},[o]),p=r.useCallback(()=>{if(!(!f.current||!n.current||o!==null)){if(!window.grecaptcha||!window.grecaptcha.render){setTimeout(p,100);return}try{console.log("Rendering reCAPTCHA v2 widget");const i=window.grecaptcha.render(n.current,{sitekey:a,callback:x=>{console.log("‚úÖ reCAPTCHA v2 completed"),t({token:x,type:"recaptcha-v2",verified:!0})},"expired-callback":()=>{console.log("‚è∞ reCAPTCHA v2 expired"),t({token:null,type:"recaptcha-v2",verified:!1})},"error-callback":x=>{console.error("‚ùå reCAPTCHA v2 error:",x),c("reCAPTCHA verification failed"),t({token:null,type:"recaptcha-v2",verified:!1,error:x})}});u(i),h(!0),c(null),console.log("‚úÖ reCAPTCHA v2 widget rendered successfully")}catch(i){console.error("‚ùå Error initializing reCAPTCHA v2:",i),c(i.message||"Failed to load reCAPTCHA"),t({token:null,type:"recaptcha-v2",verified:!1,error:i.message})}}},[a,t,o]),C=r.useCallback(()=>{if(window.grecaptcha){p();return}const i=document.createElement("script");i.src="https://www.google.com/recaptcha/api.js",i.async=!0,i.defer=!0,i.onload=()=>{console.log("reCAPTCHA script loaded"),setTimeout(p,100)},i.onerror=()=>{c("Failed to load reCAPTCHA script")},document.head.appendChild(i)},[p]);return r.useEffect(()=>{if(f.current=!0,!a){c("No reCAPTCHA site key provided");return}return C(),()=>{f.current=!1,s()}},[a,C,s]),l?e.jsxs("div",{style:{border:"2px solid #f44336",borderRadius:"4px",padding:"15px",background:"#ffeaea",color:"#d32f2f",margin:"10px 0"},children:[e.jsx("strong",{children:"‚ùå reCAPTCHA Error:"})," ",l]}):e.jsxs("div",{style:{margin:"20px 0"},children:[e.jsx("div",{ref:n,className:"g-recaptcha"}),!d&&!l&&e.jsx("div",{style:{padding:"15px",color:"#666",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",textAlign:"center"},children:"üîÑ Loading reCAPTCHA..."})]})},H=({siteKey:a,action:t="submit",onVerify:n})=>{const[d,h]=r.useState(!1),o=r.useRef(!0),u=r.useCallback(()=>{if(!window.grecaptcha||!window.grecaptcha.ready){console.log("reCAPTCHA v3 not ready");return}window.grecaptcha.ready(()=>{window.grecaptcha.execute(a,{action:t}).then(c=>{console.log("‚úÖ reCAPTCHA v3 token received"),n({token:c,type:"recaptcha-v3",action:t,verified:!0})}).catch(c=>{console.error("‚ùå reCAPTCHA v3 error:",c),n({token:null,type:"recaptcha-v3",verified:!1,error:c})})})},[a,t,n]),l=r.useCallback(()=>{if(window.grecaptcha){h(!0);return}const c=document.createElement("script");c.src=`https://www.google.com/recaptcha/api.js?render=${a}`,c.async=!0,c.defer=!0,c.onload=()=>{console.log("reCAPTCHA v3 script loaded"),h(!0)},c.onerror=()=>{console.error("Failed to load reCAPTCHA v3 script")},document.head.appendChild(c)},[a]);return r.useEffect(()=>{if(o.current=!0,!a){console.error("No reCAPTCHA v3 site key provided");return}return l(),()=>{o.current=!1}},[a,l]),r.useEffect(()=>{d&&o.current&&u()},[d,u]),r.useEffect(()=>{d&&(window.executeRecaptcha=u)},[d,u]),null},R=({siteKey:a,onVerify:t})=>{const n=r.useRef(null),[d,h]=r.useState(!1),[o,u]=r.useState(null),l=r.useRef(!0),c=r.useCallback(()=>{if(!(!l.current||!n.current||o!==null)){if(!window.hcaptcha){setTimeout(c,100);return}try{const s=window.hcaptcha.render(n.current,{sitekey:a,callback:p=>{console.log("‚úÖ hCaptcha verified"),t({token:p,type:"hcaptcha",verified:!0})},"expired-callback":()=>{console.log("‚è∞ hCaptcha expired"),t({token:null,type:"hcaptcha",verified:!1})},"error-callback":p=>{console.error("‚ùå hCaptcha error:",p),t({token:null,type:"hcaptcha",verified:!1,error:p})}});u(s),h(!0),console.log("‚úÖ hCaptcha widget rendered")}catch(s){console.error("‚ùå Error initializing hCaptcha:",s)}}},[a,t,o]),f=r.useCallback(()=>{if(window.hcaptcha){c();return}const s=document.createElement("script");s.src="https://js.hcaptcha.com/1/api.js",s.async=!0,s.defer=!0,s.onload=()=>{console.log("hCaptcha script loaded"),setTimeout(c,100)},document.head.appendChild(s)},[c]);return r.useEffect(()=>{if(l.current=!0,!!a)return f(),()=>{if(l.current=!1,o!==null&&window.hcaptcha&&window.hcaptcha.reset)try{window.hcaptcha.reset(o)}catch(s){console.log("Error resetting hCaptcha:",s)}}},[a,f,o]),e.jsxs("div",{style:{margin:"20px 0"},children:[e.jsx("div",{ref:n,className:"h-captcha"}),!d&&e.jsx("div",{style:{padding:"15px",color:"#666",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:"4px",textAlign:"center"},children:"üîÑ Loading hCaptcha..."})]})},v=({name:a="website"})=>e.jsx("input",{type:"text",name:a,style:{position:"absolute",left:"-9999px",top:"-9999px",width:"1px",height:"1px",opacity:0,pointerEvents:"none"},tabIndex:"-1",autoComplete:"off","aria-hidden":"true"}),b=({onTimeSet:a})=>(r.useEffect(()=>{const t=Math.floor(Date.now()/1e3);a(t)},[a]),null),P=({children:a,verificationType:t="recaptcha-v2",version:n="v2",recaptchaSiteKey:d,hcaptchaSiteKey:h,action:o="submit",onVerificationComplete:u,debug:l=!1,showBeforeSubmit:c=!0})=>{const[f,s]=r.useState(null),[p,C]=r.useState(null),[i,x]=r.useState("pending"),[k,j]=r.useState(!1),w=g=>{l&&console.log("üîç Verification result:",g),s(g.token),j(g.verified||!1),x(g.verified?"verified":"failed"),u&&u({...g,formStartTime:p,verificationType:`${t}-${n}`})},A=g=>{C(g)},m=()=>t==="none"?null:t==="recaptcha"&&n==="v2"&&d?e.jsx(T,{siteKey:d,onVerify:w}):t==="recaptcha"&&n==="v3"&&d?e.jsx(H,{siteKey:d,action:o,onVerify:w}):t==="hcaptcha"&&h?e.jsx(R,{siteKey:h,onVerify:w}):null;return t==="none"?e.jsxs("div",{children:[e.jsx(b,{onTimeSet:A}),e.jsx(v,{}),a]}):t==="recaptcha"&&!d?(console.error("‚ùå reCAPTCHA site key is required"),e.jsx("div",{style:{color:"red",padding:"15px",border:"1px solid red",borderRadius:"4px"},children:"‚ùå Error: reCAPTCHA site key is missing"})):t==="hcaptcha"&&!h?(console.error("‚ùå hCaptcha site key is required"),e.jsx("div",{style:{color:"red",padding:"15px",border:"1px solid red",borderRadius:"4px"},children:"‚ùå Error: hCaptcha site key is missing"})):e.jsxs("div",{children:[e.jsx(b,{onTimeSet:A}),e.jsx(v,{}),l&&e.jsxs("div",{style:{background:"#e3f2fd",padding:"15px",margin:"10px 0",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:[e.jsx("strong",{children:"üîç Debug Info:"}),e.jsx("br",{}),"Type: ",t," ",n,e.jsx("br",{}),"Site Key: ",d?.substring(0,20),"...",e.jsx("br",{}),"Status: ",i,e.jsx("br",{}),"Verified: ",k?"Yes":"No",e.jsx("br",{}),"Has Token: ",f?"Yes":"No",e.jsx("br",{}),"Domain: ",typeof window<"u"?window.location.hostname:"N/A"]}),c&&m(),a,!c&&m()]})};export{P as H,v as a};
